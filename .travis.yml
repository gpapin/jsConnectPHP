language: php

php:
    - 5.4
    - 5.5
    - 5.6
    - 7.0
    - 7.1
    - hhvm

matrix:
    fast_finish: true

install:
    - composer self-update
    - composer install -o
    - |
      if [[ ${TRAVIS_PHP_VERSION:0:2} == "7." ]]; then
          composer require "phpunit/phpunit=~5.7"
      else
          if [[ ${TRAVIS_PHP_VERSION:0:3} == "5.6" ]]; then
              composer require "phpunit/phpunit=~5"
          else
              if [[ ${TRAVIS_PHP_VERSION:0:1} == "5" ]]; then
                  composer require "phpunit/phpunit=~4.8"
              else
                  composer require "phpunit/phpunit=~5.7"
              fi
          fi
      fi

script: ./vendor/bin/phpunit -c phpunit.xml.dist --coverage-clover=coverage.clover

after_script:
    - wget https://scrutinizer-ci.com/ocular.phar
    - php ocular.phar code-coverage:upload --format=php-clover coverage.clover
